(function(){"use strict";let n=null,a=null,s="/";async function r(){try{if(location.hostname==="localhost"||location.hostname==="127.0.0.1")return;const t=await fetch(s,{cache:"no-cache",method:"HEAD"}),e=t.headers.get("etag")||t.headers.get("last-modified");if(!e)return;if(!n){n=e;return}e&&n&&e!==n&&(console.warn("[版本检查] 发现新版本：",e),postMessage({type:"version-update",versionTag:e}),n=e)}catch(t){console.error("[版本检查] 检查失败：",t)}}function o(t,e){if(a&&(clearInterval(a),a=null),t<=0)return;s=e;const c=t*60*1e3;a=setInterval(r,c),r()}addEventListener("message",t=>{switch(t.data.type){case"check":{r();break}case"start":{const{interval:e,url:c}=t.data;o(e,c);break}case"stop":{a&&(clearInterval(a),a=null);break}}})})();
